{"id":4120,"date":"2019-03-24T18:19:19","date_gmt":"2019-03-24T18:19:19","guid":{"rendered":"https:\/\/help.perfexcrm.com\/?p=4120"},"modified":"2021-12-18T22:46:03","modified_gmt":"2021-12-18T22:46:03","slug":"working-with-forms","status":"publish","type":"post","link":"https:\/\/help.perfexcrm.com\/working-with-forms\/","title":{"rendered":"Working With Forms"},"content":{"rendered":"\n<p>Perfex CRM by default has enabled <strong>CSRF<\/strong> protection, there is ability to disable this protection by the user but you must make sure that your module forms works fine when <strong>CSRF<\/strong> protection is enabled.<\/p>\n\n\n\n<p>To get more familiar how this works, visit this link:  <\/p>\n\n\n\n<p><a href=\"https:\/\/codeigniter.com\/userguide3\/general\/security.html?highlight=csrf#csrf-protection\">https:\/\/codeigniter.com\/userguide3\/general\/security.html?highlight=csrf#csrf-protection<\/a><\/p>\n\n\n\n<p>More information about <strong>CSRF<\/strong> can be found here:  <br><a href=\"https:\/\/en.wikipedia.org\/wiki\/Cross-site_request_forgery\">https:\/\/en.wikipedia.org\/wiki\/Cross-site_request_forgery<\/a> <\/p>\n\n\n\n<h3 class=\"wp-block-heading\">HTML Forms<\/h3>\n\n\n\n<p><strong>You must use the CodeIgniter helper function for forms to open a form in order for the function to generate the CSRF form token.<\/strong><\/p>\n\n\n\n<p>All Perfex CRM forms that comes with the installation uses<a href=\"https:\/\/www.codeigniter.com\/user_guide\/helpers\/form_helper.html\"> <\/a><strong><a href=\"https:\/\/codeigniter.com\/userguide3\/helpers\/form_helper.html?highlight=form_open#form_open\">form_open()<\/a> <\/strong>functions to open a form element.<br><\/p>\n\n\n\n<p> Find below an example form that use form_open().<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>&lt;?php echo form_open(admin_url('departments\/department')); ?&gt;\n&lt;!-- Your form input fields goes here --&gt;\n&lt;?php echo form_close(); ?&gt;<\/code><\/pre>\n\n\n\n<h2 class=\"wp-block-heading\">AJAX Request<\/h2>\n\n\n\n<p>Perfex CRM comes with jQuery on both clients and customers area, if you are submitting a form via AJAX Request and you are using the jQuery help functions e.q. $.post or $.ajax, you won&#8217;t need to perform any additional actions because the CSRF keys are already configured.<\/p>\n\n\n\n<p>However, if you are using any external library for requests, you must include the CSRF key manually.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Exclude URL from CSRF (&gt;= v2.9.0)<\/h2>\n\n\n\n<p>If the module is in need to exclude URL from a CSRF protection, you can achieve this by creating a configuration file <strong>[MODULE_NAME]\/config\/csrf_exclude_uris.php<\/strong><\/p>\n\n\n\n<p>The file <strong>must return an array<\/strong> with excluded URI&#8217;s.<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>return &#91;\n  'mypos\/webhook',\n  'api\/other-uri',\n  ...etc\n];<\/code><\/pre>\n\n\n\n<p>Note that you can add regex matching to the URI&#8217;s as well, read more here in the Codeigniter <a href=\"https:\/\/www.codeigniter.com\/userguide3\/libraries\/security.html?highlight=csrf#cross-site-request-forgery-csrf\">guides<\/a>.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Perfex CRM by default has enabled CSRF protection, there is ability to disable this protection by the user but you must make sure that your module forms works fine when CSRF protection is enabled. To get more familiar how this works, visit this link: https:\/\/codeigniter.com\/userguide3\/general\/security.html?highlight=csrf#csrf-protection More information about CSRF can be found here: https:\/\/en.wikipedia.org\/wiki\/Cross-site_request_forgery HTML [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[54],"tags":[],"class_list":["post-4120","post","type-post","status-publish","format-standard","hentry","category-modules"],"aioseo_notices":[],"_links":{"self":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts\/4120","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/comments?post=4120"}],"version-history":[{"count":0,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts\/4120\/revisions"}],"wp:attachment":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/media?parent=4120"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/categories?post=4120"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/tags?post=4120"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}