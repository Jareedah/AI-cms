{"id":24,"date":"2017-02-10T14:22:01","date_gmt":"2017-02-10T14:22:01","guid":{"rendered":"https:\/\/help.perfexcrm.com\/?p=24"},"modified":"2022-11-07T12:04:54","modified_gmt":"2022-11-07T12:04:54","slug":"smtp-configuration","status":"publish","type":"post","link":"https:\/\/help.perfexcrm.com\/smtp-configuration\/","title":{"rendered":"Email\/SMTP Configuration"},"content":{"rendered":"<p>You will need to configure SMTP settings for Perfex CRM if you want to send e.q. invoices, estimates, overdue reminders etc&#8230; the SMTP config will act as a general email from Perfex CRM for all emails that will be sent.<\/p>\n<p>In order to configure the send email feature in Perfex CRM navigate to <strong>Setup-&gt;Settings-&gt;Email.<\/strong><\/p>\n<div class=\"st-alert st-alert-info \">Outlook\/Office accounts are not supported for sending emails via SMTP as Microsoft dropped support for the regular SMTP connection.<\/div>\n<h3 id=\"config\">Configuration options<\/h3>\n<p>Below you can read about the email configuration option to get more familiar with, however, in most cases, you will need to adjust only a few of them as mentioned in our <a href=\"#examples\">examples<\/a> below.<\/p>\n<h4><strong>Mail Engine<\/strong><\/h4>\n<p>Perfex CRM offers two email engines, by default PHPMailer will be selected. The difference between mail engine is the libraries used to send emails from Perfex CRM.<\/p>\n<p>If you decide to use PHPMailer (which is recommended), the responsible library for this will the popular php email library PHPMailer, you can read more about the library by clicking <a href=\"https:\/\/github.com\/PHPMailer\/PHPMailer\">here<\/a><\/p>\n<p>The other mail engine is the default Codeigniter framework library, more info can be found by clicking <a href=\"https:\/\/www.codeigniter.com\/user_guide\/libraries\/email.html\">here<\/a><\/p>\n<p>However, you should not worry about this that much, just select the one that you think fits for you.<\/p>\n<h4><strong>Email Protocol<\/strong><\/h4>\n<p>SMTP, Sendmail, and Mail.<\/p>\n<p><strong>It&#8217;s highly recommended to configure the SMTP protocol<\/strong> for sending emails if you don&#8217;t want to encounter issues with emails going to spam or encoding, the examples below will be strictly for the SMTP protocol as it&#8217;s the recommended one.<\/p>\n<h4><strong>Email Encryption<\/strong><\/h4>\n<ul>\n<li><strong>SSL<\/strong> &#8211; Select if you are configuring SMTP with port <strong>465<\/strong><\/li>\n<li><strong>TLS<\/strong> &#8211; Select if you are configuring SMTP with port <strong>587<\/strong><\/li>\n<li><strong>None<\/strong> &#8211; Select if you are configuring SMTP with port <strong>25<\/strong><\/li>\n<\/ul>\n<p>Summarized, SSL works with port 465, TLS works with port 587 and if you are trying to configure the SMTP config with port 25 (non-secure) there will be no encryption and you should select None.<\/p>\n<h4><strong>SMTP Host<\/strong><\/h4>\n<p>Enter your SMTP hostname.<\/p>\n<h4><strong>SMTP Port<\/strong><\/h4>\n<p>Enter your SMTP port<\/p>\n<p><strong>Don&#8217;t mix up<\/strong> these modes; Email encryption set to SSL on port 587 or TLS on port 465 will not work.<\/p>\n<h4><strong>Email<\/strong><\/h4>\n<p>Enter the SMTP email you are trying to configure as a general email for Perfex CRM, in most cases, this will be a mail only used for sending emails from Perfex CRM, e.q. you can create an email account with name no-reply@ or info@, however, this is up to you to determine how best fit for your needs.<\/p>\n<h4><strong>SMTP Username<\/strong><\/h4>\n<p>Fill only if your email client use username for SMTP login, mostly you will fill this field if you are using an exchange mailbox.<\/p>\n<p>In most cases when you are using\u00a0 exchange server, you will need to log in with username not with the email address, in this case, Perfex CRM will use the <strong>SMTP Username field to log in to your mail server instead of the email address<\/strong>, however the Email address you filled above will be still used as a FROM header.<\/p>\n<h4><strong>SMTP Password<\/strong><\/h4>\n<p>Fill the password for login, you should already know your password.<\/p>\n<h4><strong>Email Charset<\/strong><\/h4>\n<p>The default is UTF-8, you won&#8217;t need to change this ever, because in most cases this works fine, however, if you decide to change the encoding it&#8217;s highly recommended perform few researches to see what encoding is best fit for you.<\/p>\n<h4><strong>BCC All Emails To<\/strong><\/h4>\n<p>You can add email to be added as BCC header if you want to keep track and get copies of all emails sent from Perfex CRM if you need to add multiple BCC emails, separate them by a comma.<\/p>\n<h4><strong>Email Signature<\/strong><\/h4>\n<p>Global email signature for all emails sent, can be used as merge field added in\u00a0<a href=\"https:\/\/help.perfexcrm.com\/email-templates\/\">email templates<\/a> in <strong>Setup-&gt;Email Templates<\/strong>, keep in mind <strong>this option can be overridden<\/strong> if e.q. the staff that is sending an invoice to an email have configured custom email signature in his profile.<\/p>\n<h4><strong>Predefined Header &amp;\u00a0Predefined Footer<\/strong><\/h4>\n<p>Perfex CRM installation by default comes with a predefined header and predefined footer for all email templates, the predefined header and footer is pretty clean but if you need something more then this, feel free to adjust the code.<\/p>\n<p>The <strong>email message contents are merged in between<\/strong> the predefined header and footer e.q.<\/p>\n<hr \/>\n<p>[predefined header code]<\/p>\n<p>The email message<\/p>\n<p>[predefined footer code]<\/p>\n<hr \/>\n<p>So for example, if you opened a &lt;div&gt; in the header and you did not close the &lt;div&gt; HTML while formatting the header, you MUST close\u00a0 (&lt;\/div&gt;) the HTML tag in the footer.<\/p>\n<p>Click <a href=\"https:\/\/www.w3schools.com\/Html\/\">here<\/a> to learn more about HTML<\/p>\n<h3>AWS Email SMTP Setup<\/h3>\n<p>In case you are using AWS for sending emails, click <a href=\"https:\/\/help.perfexcrm.com\/aws-email-smtp-setup\/\">here<\/a> to learn more.<\/p>\n<h3>Email Queue<\/h3>\n<p>If you are looking in the Email Queue option, click <a href=\"https:\/\/help.perfexcrm.com\/email-queue\/\">here<\/a> to read more.<\/p>\n<h3>Email Templates<\/h3>\n<p>Click <a href=\"https:\/\/help.perfexcrm.com\/email-templates\/\">here<\/a> to read more about the email templates in Perfex CRM<\/p>\n<h3 id=\"examples\">Examples<\/h3>\n<p>The below examples are general examples how to configure SMTP to send an email, keep in mind that the examples may be different then your actual server requirements, the best is to consult with your hosting provider to provide you the correct SMTP configuration.<\/p>\n<h4><strong>SMTP server over port 25<\/strong><\/h4>\n<p>Encryption: None<br \/>\nSMTP Host: yoursmtphost.com<br \/>\nSMTP Port : 25<br \/>\nSMTP Email:\u00a0Your email<br \/>\nSMTP Password: Your password<\/p>\n<h4><strong>SMTP servers that require SSL connection<\/strong><\/h4>\n<p>Encryption: SSL<br \/>\nSMTP Host: yoursmtphost.com<br \/>\nSMTP Port :\u00a0465<br \/>\nSMTP Email:\u00a0Your email<br \/>\nSMTP Password: Your password<\/p>\n<h4><b>For Gmail use the following configuration:<\/b><\/h4>\n<p>Encryption: SSL<br \/>\nSMTP Host: smtp.gmail.com<br \/>\nSMTP Port :\u00a0465\u00a0\/ For TLS encryption use port 587<br \/>\nSMTP Email:\u00a0youremail@gmail.com<br \/>\nSMTP Password: Your password<\/p>\n<div class=\"st-alert st-alert- \">If you are using your<strong> Google Account<\/strong> password to connect to SMTP, it&#8217;s highly recommended to <strong>update your password with an App Password<\/strong> to avoid any email sending disruptions, find more information on how to generate App Password for your Google Account at the following link: <a href=\"https:\/\/support.google.com\/accounts\/answer\/185833?hl=en\">https:\/\/support.google.com\/accounts\/answer\/185833?hl=en<\/a><\/div>\n<h3>Testing SMTP Setup<\/h3>\n<p>If you need to test your SMTP setup\u00a0just go to\u00a0<strong>Setup -&gt; Settings -&gt; Email<\/strong>\u00a0and scroll down to\u00a0<strong>Send Test Email\u00a0<\/strong>to enter your email address and click the submit button. If the SMTP is setup correctly you will receive green notifications saying that your email is set up correctly also an email will be sent to the email address you entered otherwise\u00a0debug message from the email client will be shown.<\/p>\n<p>After you configure the SMTP settings, you will need to test if the configuration is properly configured and it is working fine.<\/p>\n<p>While you are in <strong>Setup-&gt;Settings-&gt;Email and\u00a0<\/strong>scroll down to\u00a0<strong>Send Test Email<\/strong>\u00a0to enter your email address and click the submit button. If the SMTP is setup correctly you will receive green notifications saying that your email is set up correctly also an email will be sent to the email address you entered otherwise\u00a0debug message from the email client will be shown.<\/p>\n<h2 id=\"common_issues\">Common Issues &amp; Troubleshooting<\/h2>\n<p>When you try to send a test email, if the configuration is not successfully, you will be able to see an error block on the top, please read the debug block message carefully so you can determine what is causing your issue, the debug block message will contain the error message returned from your email server, in most cases will be something like: <strong>&#8220;Connection failed. Error #2: stream_socket_client(): unable to connect to ssl:\/\/smtp.gmail.com:465 (Connection refused) &#8221; <\/strong>but this will depend on your mail server and the mail engine you are using (PHPmailer or Codeigniter), however, most of the error messages will be similar.<\/p>\n<p><strong>We highly recommend you to consult with your hosting provider if you are not able to configure SMTP for Perfex CRM<\/strong>, the problem in most cases is related to your server config e.q. DNS failure, firewall blocking, hosting provider is blocking outbound connections etc&#8230; you should talk to them, read their docs, in this case, only your hosting provider can help you!<\/p>\n<p>You may want to perform a few types of research about the specific error message you are getting to get more familiar with how you can resolve this. <strong>ServerSMTP<\/strong> posted a good <a href=\"https:\/\/serversmtp.com\/smtp-error\/\">article<\/a> and guides for common SMTP errors and codes, also <strong>it&#8217;s highly recommended to check the<\/strong> <strong>PHPMailer troubleshooting guide<\/strong> by clicking <a href=\"https:\/\/github.com\/PHPMailer\/PHPMailer\/wiki\/Troubleshooting\">here<\/a><\/p>\n<h3><strong>Email settings not saving or getting 404 error when saving<\/strong><\/h3>\n<div class=\"tm\">This can happen because of firewall rules configured on your web server, because in Setup-&gt;Settings-&gt;Email in the predefined option header and footer there is an HTML and the firewall is preventing this HTML saves into the database.<\/div>\n<div class=\"tm\"><\/div>\n<div class=\"tm\">To test this you can navigate to Setup-&gt;Settings-&gt;Email and<strong> leave blank the predefined header and footer options <\/strong>then try to save the settings to see if this will work fine.<\/div>\n<div class=\"tm\"><\/div>\n<div class=\"tm\">If the save is successful, you should try to consult with your hosting provider to disable such firewall rules, in most cases, this can happen because of the <b>mod_security <\/b>or <b>Suhosin.<\/b><\/div>\n<h3>Failed to connect to server: 111 Connection refused<\/h3>\n<p><strong>Connection refused<\/strong> error is thrown directly from your mail server and may happen if your hosting provider is blocking outbound ports, SMTP, in most cases happens because of blocked ports via a firewall.<\/p>\n<p>If you are configuring SMTP on ports 465 or 587, make sure that the ports 465 and 587 are open, if you are not managing the server, <strong>contact your hosting provider to check this<\/strong> directly.<\/p>\n<p>More information:<\/p>\n<p><a href=\"https:\/\/github.com\/PHPMailer\/PHPMailer\/issues\/295#issuecomment-155147551\">https:\/\/github.com\/PHPMailer\/PHPMailer\/issues\/295#issuecomment-155147551<\/a><\/p>\n<p><a href=\"https:\/\/github.com\/PHPMailer\/PHPMailer\/wiki\/Troubleshooting\">https:\/\/github.com\/PHPMailer\/PHPMailer\/wiki\/Troubleshooting<\/a><\/p>\n<h3>Connection Timeout Error and DNS Failures<\/h3>\n<p>Click <a href=\"https:\/\/github.com\/PHPMailer\/PHPMailer\/wiki\/Troubleshooting#dns-failures\">here<\/a> to read more.<\/p>\n<h3>GoDaddy Email Config Issues<\/h3>\n<p>GoDaddy blocks outbound SMTP; you have to use GoDaddy&#8217;s own mail servers.<\/p>\n<p>Click <a href=\"https:\/\/github.com\/PHPMailer\/PHPMailer\/wiki\/Troubleshooting#godaddy\">here<\/a> to read more.<\/p>\n<h3>Authentication failures<\/h3>\n<p>If your authentication is failing, there are several likely causes:<\/p>\n<ul>\n<li>You have the wrong username or password<\/li>\n<li>Your connection is being diverted to a different server (as above)<\/li>\n<li>You have specified authentication without encryption<\/li>\n<\/ul>\n<p>Generally, you do not want to send username or password over an unencrypted link. Some SMTP authentication schemes do add a minimal level of security (sending short hashes rather than clear text), but these provide only minimal protection, and so most servers do not allow authentication without encryption. Fix this by setting SMTP Encryption to TLS and Port to 587 as well as filling the Email and Password field.<\/p>\n<h3><strong>Common issues with Gmail or G Suite &#8211; Invalid username or password<\/strong><\/h3>\n<p>Invalid username or password when use Gmail or G-Suite can be a common error if you haven&#8217;t turned Less Secure Apps to ON, however, it&#8217;s recommended first to check if your password is correct.<\/p>\n<h4><strong>G-Suite<\/strong><\/h4>\n<ol>\n<li>Sign in to the Google Admin console.<\/li>\n<li>Click Security &gt; Basic settings.<\/li>\n<li>Under Less secure apps, select Go to settings for less secure apps.<\/li>\n<li>In the subwindow, select the Allow users to manage their access to less secure apps radio button.<\/li>\n<li>In case you are not receiving the emails and your SMTP configuration test email is showing that the configuration is working properly, take a look at the following articles:\n<ol>\n<li><a href=\"https:\/\/productforums.google.com\/forum\/#!topic\/Apps\/M7TiKQAWhq4\">https:\/\/productforums.google.com\/forum\/#!topic\/Apps\/M7TiKQAWhq4<\/a><\/li>\n<li><a href=\"https:\/\/support.google.com\/a\/answer\/55299?hl=en\">https:\/\/support.google.com\/a\/answer\/55299?hl=en<\/a><\/li>\n<\/ol>\n<\/li>\n<\/ol>\n<h4><strong>Gmail Regular Account<\/strong><\/h4>\n<ol>\n<li>Log in to your user account.<\/li>\n<li>Visit: <a href=\"https:\/\/www.google.com\/settings\/security\/lesssecureapps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https:\/\/www.google.com\/settings\/security\/lesssecureapps<\/a><\/li>\n<li>Toggle on.<\/li>\n<\/ol>\n<h4><strong>2 Factor Authentication Enabled<\/strong><\/h4>\n<p>If you are<strong> have enabled 2-factor authentication<\/strong> on your Google Account, you <strong>MUST<\/strong> generate application password and add the password in the password field in Perfex CRM located in Setup-&gt;Settings-&gt;Email<\/p>\n<p>Click <a href=\"https:\/\/support.google.com\/accounts\/answer\/185833?hl=en\">here<\/a> to read how to generate App Password.<\/p>\n<hr \/>\n<p>If you are still getting <strong>invalid username or password and you are managing the server<\/strong> try this:<\/p>\n<ol>\n<li>Log in as cPanel user, go to MX Entry, select domain, set to the remote exchanger.<\/li>\n<li>Log into WHM, go to Tweak Settings, disable &#8220;Restrict outgoing SMTP&#8221;<\/li>\n<\/ol>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-26\" src=\"https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/02\/restroct-outgoing-smtp-to-root-exim-1024x56.png\" alt=\"Restrict outgoing smtp to root exim\" width=\"980\" height=\"54\" srcset=\"https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/02\/restroct-outgoing-smtp-to-root-exim.png 1024w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/02\/restroct-outgoing-smtp-to-root-exim-300x16.png 300w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/02\/restroct-outgoing-smtp-to-root-exim-768x42.png 768w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/02\/restroct-outgoing-smtp-to-root-exim-60x3.png 60w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/02\/restroct-outgoing-smtp-to-root-exim-150x8.png 150w\" sizes=\"auto, (max-width: 980px) 100vw, 980px\" \/><\/p>\n<h3>Could not instantiate mail function<\/h3>\n<p>This error is also known as &#8220;<strong>Unable to send email using PHP mail()<\/strong>&#8221; if you are using the Codeigniter mail engine and means that your PHP installation is not configured to call the <strong>mail()<\/strong> function correctly (e.g. sendmail_path is not set correctly in your php.ini), or you have no local mail server installed and configured.<\/p>\n<p>Click <a href=\"https:\/\/github.com\/PHPMailer\/PHPMailer\/wiki\/Troubleshooting#could-not-instantiate-mail-function\">here<\/a> to read more.<\/p>\n<p>However, the error may be shown if you are trying to configure the <strong>Mail<\/strong> protocol, which is not recommended.<\/p>\n<h3>SELinux blocking<\/h3>\n<p>If you see an error like\u00a0<strong>SMTP -&gt; ERROR: Failed to connect to server: Permission denied (13)<\/strong>, you may be running into SELinux preventing PHP or the web server from sending an email.<\/p>\n<p>Click <a href=\"https:\/\/github.com\/PHPMailer\/PHPMailer\/wiki\/Troubleshooting#selinux-blocking\">here<\/a> to read more.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>You will need to configure SMTP settings for Perfex CRM if you want to send e.q. invoices, estimates, overdue reminders etc&#8230; the SMTP config will act as a general email from Perfex CRM for all emails that will be sent. In order to configure the send email feature in Perfex CRM navigate to Setup-&gt;Settings-&gt;Email. Configuration [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[25],"tags":[],"class_list":["post-24","post","type-post","status-publish","format-standard","hentry","category-email-config-and-templates"],"aioseo_notices":[],"_links":{"self":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts\/24","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/comments?post=24"}],"version-history":[{"count":0,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts\/24\/revisions"}],"wp:attachment":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/media?parent=24"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/categories?post=24"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/tags?post=24"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}