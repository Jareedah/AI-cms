{"id":830,"date":"2017-03-15T20:05:28","date_gmt":"2017-03-15T20:05:28","guid":{"rendered":"https:\/\/help.perfexcrm.com\/?p=830"},"modified":"2020-10-08T09:15:02","modified_gmt":"2020-10-08T09:15:02","slug":"stripe","status":"publish","type":"post","link":"https:\/\/help.perfexcrm.com\/stripe\/","title":{"rendered":"Stripe Checkout"},"content":{"rendered":"\n<div class=\"st-alert st-alert- \">Stripe Checkout requires your Perfex CRM installation to run on HTTPS url, read more here: <a href=\"https:\/\/stripe.com\/docs\/web\/setup#http-requirements\">https:\/\/stripe.com\/docs\/web\/setup#http-requirements<\/a><\/div>\n<p>\nIf your Perfex CRM installation is not running on HTTPS Url and you recently activated your SSL certificate for your domain, you should consider changing your Perfex CRM base url to start with HTTPS as explained here: <a href=\"https:\/\/help.perfexcrm.com\/switch-to-https-after-installing-to-http\/\">https:\/\/help.perfexcrm.com\/switch-to-https-after-installing-to-http\/<\/a>\n<\/p>\n\n\n\n<h4 class=\"wp-block-heading\">Configure API Keys<\/h4>\n\n\n\n<p>Stripe Checkout can be configured in  <strong>Setup-&gt;Settings-&gt;Payment Gateways-&gt;Stripe Checkout<\/strong>.<\/p>\n\n\n\n<p>To set up Stripe Checkout, you will need API Secret and Publishable key.<\/p>\n\n\n\n<p>To get these, please follow the steps below:<\/p>\n\n\n\n<ol class=\"wp-block-list\"><li>Log in to your Stripe account<\/li><li>Click &#8220;<strong>Developers<\/strong>&#8221; from the top left menu item of the page<\/li><li>Click the &#8220;<strong>API Keys<\/strong>&#8221; submenu item<\/li><\/ol>\n\n\n\n<p>If you toggled &#8220;<strong>View test data<\/strong>&#8220;, Stripe will show the test keys, otherwise, the live keys will be shown.<\/p>\n\n\n\n<ul class=\"wp-block-list\"><li>For <strong>production<\/strong>, you will need the &#8220;<strong>Live Secret Key<\/strong>&#8221; and &#8220;<strong>Live Publishable Key<\/strong>&#8220;.<\/li><li>For <strong>testing<\/strong>, you will need the &#8220;<strong>Test Secret Key<\/strong>&#8221; and &#8220;<strong>Test Publishable Key<\/strong>&#8221; <\/li><\/ul>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" decoding=\"async\" width=\"1024\" height=\"418\" src=\"https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-api-keys-1024x418.png\" alt=\"Stripe API keys\" class=\"wp-image-3565\" srcset=\"https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-api-keys-1024x418.png 1024w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-api-keys-300x123.png 300w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-api-keys-768x314.png 768w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-api-keys-60x25.png 60w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-api-keys-150x61.png 150w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-api-keys.png 1128w\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" \/><\/figure>\n\n\n\n<h4 class=\"wp-block-heading\">Webhook<\/h4>\n\n\n\n<p><strong>Starting from Perfex CRM version 2.4.0<\/strong>, the Stripe checkout integration works with webhooks.<br><br><strong>After the Stripe API credentials are saved<\/strong>, Perfex CRM will show you a message that the webhook is not configured for the current mode (testing or live based on your API credentials)<br><br>To spare you from manually configuring the webhook, we added functionality to automatically create the webhook in Stripe.<\/p>\n\n\n\n<figure class=\"wp-block-image is-resized\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-webhook-1024x193.png\" alt=\"\" class=\"wp-image-4155\" width=\"580\" height=\"109\" srcset=\"https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-webhook-1024x193.png 1024w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-webhook-300x57.png 300w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-webhook-768x145.png 768w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-webhook-60x11.png 60w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-webhook-150x28.png 150w, https:\/\/help.perfexcrm.com\/wp-content\/uploads\/2017\/03\/stripe-webhook.png 1236w\" sizes=\"auto, (max-width: 580px) 100vw, 580px\" \/><\/figure>\n\n\n\n<p>Just click on the<strong> &#8220;here&#8221;<\/strong> link in the message text to create the webhook in Stripe.<\/p>\n\n\n\n<div class=\"st-alert st-alert- \">\nKeep in mind that at first if you added test Stripe API credentials, you will need to repeat this step again when you add your live API credentials.\n<\/div>\n\n\n\n<h4 class=\"wp-block-heading\">Mod Security<\/h4>\n\n\n\n<p>In case you are getting <strong>Access to this resource on the server is denied <\/strong>or <strong>Not Acceptable<\/strong> mod_security errors when Stripe is redirecting back to Perfex CRM after payment, contact your hosting and ask them to<strong> disable mod_security for your Perfex CRM installation<\/strong> because in certain scenarios ModSecurity will interfere with Perfex CRM features.<\/p>\n\n\n\n<h4 class=\"wp-block-heading\">Testing<\/h4>\n\n\n\n<p>After you entered the <strong>test Stripe API credentials<\/strong> and created the webhook, you can perform the following steps:<\/p>\n\n\n\n<ol class=\"wp-block-list\"><li>Create a dummy customer.<\/li><li>Create an invoice under the customer you created before and in the <strong>Allowed Payment Modes<\/strong> make sure that you select <strong>Stripe<\/strong><\/li><li>View the invoice as a customer, while previewing the invoice in the admin area click <strong>More-&gt;View Invoice as Customer<\/strong>.<\/li><li>Scroll to the bottom and select <strong>Stripe <\/strong>and click <strong>Pay Now<\/strong><\/li><li>If you need test credit cards, you can read more in the Stripe <a href=\"https:\/\/stripe.com\/docs\/testing#cards\">testing guide page<\/a><\/li><\/ol>\n\n\n\n<h4 class=\"wp-block-heading\">Notes (applicable only for Perfex CRM versions below 2.4.0)<\/h4>\n\n\n\n<p>Keep in mind that once you make the first payment with Stripe under your dummy customer (or any other customer), Perfex CRM will create a separate customer in Stripe dashboard and will store the customer id inside Perfex CRM database, this ID will be used for future payments and the credit card you entered the first time will be used as default source for this customer.<\/p>\n\n\n\n<p><strong>After you disable testing mode and change the API keys to production, the customer you created for testing purposes won&#8217;t work anymore with the production API keys, means that you won&#8217;t be able to perform tests again with this customer with your production keys, you should delete this customer because the script won&#8217;t be able to fetch this customer from Stripe because the customer ID is actually from the testing data not from production data.<\/strong><\/p>\n\n\n\n<p>However, if you are familiar with working with phpmyadmin, you can easily set the field <strong>stripe_id<\/strong> in tbclients table to null.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>If your Perfex CRM installation is not running on HTTPS Url and you recently activated your SSL certificate for your domain, you should consider changing your Perfex CRM base url to start with HTTPS as explained here: https:\/\/help.perfexcrm.com\/switch-to-https-after-installing-to-http\/ Configure API Keys Stripe Checkout can be configured in Setup-&gt;Settings-&gt;Payment Gateways-&gt;Stripe Checkout. To set up Stripe Checkout, [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[4],"tags":[],"class_list":["post-830","post","type-post","status-publish","format-standard","hentry","category-payment-gateways"],"aioseo_notices":[],"_links":{"self":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts\/830","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/comments?post=830"}],"version-history":[{"count":0,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/posts\/830\/revisions"}],"wp:attachment":[{"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/media?parent=830"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/categories?post=830"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/help.perfexcrm.com\/wp-json\/wp\/v2\/tags?post=830"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}